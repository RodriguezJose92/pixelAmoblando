class MudiPixel{constructor(){this.testType=null,this.userID=null,this.path=null,this.device=null,this.detailDevice=null,this.date=null,this.timeInSession=null,this.skuNumber=null,this.idCompany=147,this.viewerEvent=0,this.interaction3D=0,this.interactionAR=0,this.addToCar=0,this.purchaseClick=0,this.category=null,this.subCategory=null,this.verifyAddToCarButton=0,this.verifyBreadcrumb=0,this.verifyPurchaseButton=0,this.verifyContainerMudiBtns=0,this.btnARVerify=0,this.verifySkuNumber=0,this.DBMudiProducts=indexedDB.open("productsMudi",1)}async verifyTestingAB(){let e=localStorage.getItem("UserMudiTest");if(null!==e)this.testType=e;else{let t={idCompany:this.idCompany},i=await fetch("https://viewer.mudi.com.co:3589/api/mudiv1/getInfoTest",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(t)}),s=await i.json();await this.updateTesting(s.data[0].test)}}async updateTesting(e){let t;t="A"==e?"B":"A";let i={idCompany:this.idCompany,typeTest:t};await fetch("https://viewer.mudi.com.co:3589/api/mudiv1/updateInfoTest",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(i)}),this.testType=t,localStorage.setItem("UserMudiTest",t)}verifyAddToCar(){let e=document.body.querySelector(".cart-add");if(this.verifyAddToCarButton>5e3)return console.log("%cMudiPixel:\n","color:#820ad1; font-weight:600","The button to add to cart was not found ❌"),!1;e?(e.parentNode.addEventListener("click",()=>this.addToCar++),console.log("%cMudi Pixel: \n","color:#820ad1; font-weight:600","Add To car Correctly setting \uD83D\uDE80")):(requestAnimationFrame(this.verifyAddToCar.bind(this)),this.verifyAddToCarButton++)}verifyCategory(){let e=document.body.querySelector(".breadcrumb");if(this.verifyBreadcrumb>5e3)return console.log("%cMudiPixel:\n","color:#820ad1; font-weight:600","Breadcrumb was not found ❌"),!1;e?(this.category=e.children[1].innerText,this.subCategory=e.children[2].innerText,console.log("%cMudi Pixel: \n","color:#820ad1; font-weight:600","Category Correctly setting \uD83D\uDE80")):(requestAnimationFrame(this.verifyCategory.bind(this)),this.verifyBreadcrumb++)}verifyPurchase(){let e=document.body.querySelector(".send-event-purchase");if(this.verifyPurchaseButton>5e3)return console.log("%cMudiPixel:\n","color:#820ad1; font-weight:600","Purchase was not found ❌"),!1;e?(e.addEventListener("click",()=>this.purchaseClick++),this.verifyproductInteractive3D(),console.log("%cMudi Pixel: \n","color:#820ad1; font-weight:600","Purchase Correctly setting \uD83D\uDE80")):(requestAnimationFrame(this.verifyPurchase.bind(this)),this.verifyPurchaseButton++)}verifyproductInteractive3D(){let e=document.body.querySelectorAll(".media-content-details");for(let t=0;t<e.length;t++){let i=e[t].querySelector(".col-xs-10").innerHTML,s=this.DBMudiProducts.result,r=s.transaction("products","readonly"),n=r.objectStore("products"),o=n.openCursor(),d=[];o.addEventListener("success",()=>{o.result?(i==o.result.value.sku&&d.push(i),o.result.continue()):console.log("consulta realizada")}),this.skuNumber=d}}verifyContainerBtnsMudi(){let e=document.body.querySelector(".btnsMudiContainer");if(this.verifyContainerMudiBtns>1500)return console.log("%cMudiPixel:\n","color:#820ad1; font-weight:600","Container Btns Mudi was not found ❌"),!1;e?(this.viewerEvent++,document.body.querySelector(".btnMudi3D").addEventListener("click",()=>{this.interaction3D++,this.verifyBtnAR()}),console.log("%cMudi Pixel: \n","color:#820ad1; font-weight:600","Container Btns Mudi Correctly setting \uD83D\uDE80")):(requestAnimationFrame(this.verifyContainerBtnsMudi.bind(this)),this.verifyContainerMudiBtns++)}verifyBtnAR(){let e=document.body.querySelector(".imgBtnAR"),t=!1;if(this.btnARVerify>1500)return console.log("%cMudiPixel:\n","color:#820ad1; font-weight:600","Btn Ar mode was not found ❌"),!1;e?(e.addEventListener("click",()=>t?t=!t:(t=!t,this.interactionAR++)),console.log("%cMudi Pixel: \n","color:#820ad1; font-weight:600","Btn AR mode Correctly setting \uD83D\uDE80")):(requestAnimationFrame(this.verifyBtnAR.bind(this)),this.btnARVerify++)}verifySku(){let e=document.body.querySelector(".btnsMudiContainer");if(this.btnARVerify>1500)return console.log("%cMudiPixel:\n","color:#820ad1; font-weight:600","SkuNumber was not found ❌"),!1;e?(this.skuNumber=e.getAttribute("skunumber"),console.log("%cMudi Pixel: \n","color:#820ad1; font-weight:600","SkuNumber Correctly setting \uD83D\uDE80")):(requestAnimationFrame(this.verifySku.bind(this)),this.verifySkuNumber++)}createDB(){this.DBMudiProducts.addEventListener("upgradeneeded",()=>{DBMudiProducts.result.createObjectStore("products",{autoIncrement:!0})}),this.DBMudiProducts.addEventListener("success",()=>{console.log("Todo sali\xf3 bien")}),this.DBMudiProducts.addEventListener("error",()=>{throw Error("No pudimos abrir ni crear la base de datos del pixel de Mudi")})}createRegistryDB(){let e=this.DBMudiProducts.result,t=e.transaction("products","readwrite"),i=t.objectStore("products");i.add({sku:"3435335",fechaCreacion:"2024-05-20 23:59:59"})}deleteRegistryDB(e){let t=this.DBMudiProducts.result,i=t.transaction("products","readwrite"),s=i.objectStore("products");s.delete(e)}readObjectDB(){let e=(e,t)=>{let i=new Date().getFullYear(),s=new Date().getMonth()+1,r=new Date().getDate(),n=e.split(" ")[0].split("-");(i>n[0]||s>n[1]||r>n[2])&&this.deleteRegistryDB(t)},t=this.DBMudiProducts.result,i=t.transaction("products","readonly"),s=i.objectStore("products"),r=s.openCursor();r.addEventListener("success",()=>{r.result?(e(r.result.value.fechaCreacion,r.result.key),r.result.continue()):console.log("consulta realizada")})}async identifyUserMudi(){let e=localStorage.getItem("userMudi"),t=async()=>{try{let e=await fetch("https://viewer.mudi.com.co:3589/api/mudiv1/userAnalitycs"),t=await e.json();localStorage.setItem("userMudi",t.data.insertId),this.userID=t.data.insertId}catch(i){throw Error(i)}};e?this.userID=e:t()}getPath(){this.path=location.href}recognizeDevice(){let e={Device:null,type:"Mobile"},t=navigator.userAgent,i=t.split(" ");if(t.toLowerCase().includes("android")){let s=i[2]+" "+i[3],r=i[4]+" "+i[5];e.Device=`Android ${r} V-${s}`}else t.toLowerCase().includes("iphone")?e.Device=`iPhone OS ${i[5].split("_").join(".")}`:t.toLowerCase().includes("ipad")?e.Device=`iPad OS ${i[5].split("_").join(".")}`:t.toLowerCase().includes("Macintosh")?e.Device=`Macintosh OS ${i[6].split("_").join(".")}`:i[1].toLowerCase().includes("windows")?(e.Device=`Windows V- ${i[3].replace(";"," ")} ${i[4].replace(";"," ")}`,e.type="Desk"):t.toLowerCase().includes("linux")&&!t.toLowerCase().includes("android")?(e.Device="Linux",e.type="Desk"):(e.Device="Desconocido",e.type=null);this.device=e.type,this.detailDevice=e.Device}getDate(){let e=new Date,t={month:e.getMonth()+1,day:e.getDate(),year:e.getFullYear(),hour:e.getHours(),minute:e.getMinutes(),seconds:e.getSeconds()};this.date=`${t.year}-${t.month<10?"0"+t.month:t.month}-${t.day} ${t.hour<10?"0"+t.hour:t.hour}:${t.minute}:${t.seconds}`}timeSesion(){let e={hour:0,minutes:0,seconds:0};setInterval(()=>{e.seconds++,e.seconds<10&&(e.seconds=`0${e.seconds}`,0==e.minutes&&(e.minutes="00"),0==e.hour&&(e.hour="00")),60==e.seconds&&(e.seconds="00",e.minutes++,e.minutes<10?e.minutes=`0${e.minutes}`:e.minutes=`${e.minutes}`),60==e.minutes&&(e.minutes="00",e.hour++,e.hour<10?e.hour=`0${e.hour}`:e.hour=`${e.hour}`),this.timeInSession=`${e.hour}:${e.minutes}:${e.seconds}`},1e3)}addEventBeforeUnload(){window.addEventListener("beforeunload",e=>{fetch("https://viewer.mudi.com.co:3589/api/mudiv1/registryPixelMudi",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({userID:this.userID,path:this.path,device:this.device,detailDevice:this.detailDevice,dateMudi:this.date,timeInSession:this.timeInSession,viewEvent:this.viewerEvent,interaction3D:this.interaction3D,interactionAR:this.interactionAR,addToCar:this.addToCar,purchaseClick:this.purchaseClick,category:this.category,subCategory:this.subCategory,skuNumber:this.skuNumber,idCompany:this.idCompany,testType:this.testType})})})}async pixelMudiOn(){await this.identifyUserMudi(),this.userID&&(this.verifyTestingAB(),this.verifyAddToCar(),this.verifyCategory(),this.verifySku(),this.verifyPurchase(),this.verifyContainerBtnsMudi(),this.getPath(),this.recognizeDevice(),this.getDate(),this.timeSesion(),this.addEventBeforeUnload())}}const mudiPixel=new MudiPixel;window.mudiPixel=mudiPixel,mudiPixel.pixelMudiOn();

/** https://www.toptal.com/developers/javascript-minifier */